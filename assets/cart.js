class CartRemoveButton extends HTMLElement{constructor(){super(),this.addEventListener("click",e=>{e.preventDefault(),this.closest("cart-template").updateQuantity(this.dataset.index,0)})}}customElements.define("cart-remove-button",CartRemoveButton);class CartItems extends HTMLElement{constructor(){super(),this.lineItemStatusElement=document.getElementById("shopping-cart-line-item-status"),this.currentItemCount=Array.from(this.querySelectorAll('[name="updates[]"]')).reduce((e,t)=>e+parseInt(t.value),0),this.debouncedOnChange=debounce(e=>{this.onChange(e)},300),this.addEventListener("change",this.debouncedOnChange.bind(this))}onChange(e){this.updateQuantity(e.target.dataset.index,e.target.value,document.activeElement.getAttribute("name"))}getSectionsToRender(){return[{id:"main-cart-items",section:document.getElementById("main-cart-items").dataset.id,selector:".js-contents"},{id:"cart-products-count",section:"cart-products-count",selector:".shopify-section"},{id:"cart-live-region-text",section:"cart-live-region-text",selector:".shopify-section"},{id:"cart-footer",section:document.getElementById("cart-footer").dataset.id,selector:".js-contents"}]}updateQuantity(e,t,i){this.enableLoading(e);let n=JSON.stringify({line:e,quantity:t,sections:this.getSectionsToRender().map(e=>e.section),sections_url:window.location.pathname});fetch(`${routes.cart_change_url}`,{...fetchConfig(),body:n}).then(e=>e.text()).then(t=>{let n=JSON.parse(t);this.firstElementChild.classList.toggle("hide",0===n.item_count);let r=document.getElementById("cartEmpty");0===n.item_count&&r.classList.remove("hide",0===n.item_count);let s=document.getElementById("cart-footer");s&&s.classList.toggle("hide",0===n.item_count),this.getSectionsToRender().forEach(e=>{let t=document.getElementById(e.id).querySelector(e.selector)||document.getElementById(e.id);t.innerHTML=this.getSectionInnerHTML(n.sections[e.section],e.selector)}),this.updateLiveRegions(e,n.item_count);let a=document.getElementById(`CartItem-${e}`);a&&a.querySelector(`[name="${i}"]`)&&a.querySelector(`[name="${i}"]`).focus(),this.disableLoading()}).catch(()=>{this.querySelectorAll(".loading-overlay").forEach(e=>e.classList.add("hidden")),document.getElementById("cart-errors").textContent=window.cartStrings.error,this.disableLoading()})}updateLiveRegions(e,t){this.currentItemCount===t&&(document.getElementById(`Line-item-error-${e}`).querySelector(".cart-item__error-text").innerHTML=window.cartStrings.quantityError.replace("[quantity]",document.getElementById(`Quantity-${e}`).value)),this.currentItemCount=t,this.lineItemStatusElement.setAttribute("aria-hidden",!0);let i=document.getElementById("cart-live-region-text");i.setAttribute("aria-hidden",!1),setTimeout(()=>{i.setAttribute("aria-hidden",!0)},1e3)}getSectionInnerHTML(e,t){return new DOMParser().parseFromString(e,"text/html").querySelector(t).innerHTML}enableLoading(e){document.getElementById("main-cart-items").classList.add("cart__items--disabled"),this.querySelectorAll(`#CartItem-${e} .loading-overlay`).forEach(e=>e.classList.remove("hidden")),document.activeElement.blur(),this.lineItemStatusElement.setAttribute("aria-hidden",!1)}disableLoading(){document.getElementById("main-cart-items").classList.remove("cart__items--disabled")}}customElements.define("cart-template",CartItems);