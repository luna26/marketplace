{% if settings.popup_newsletter_show %}
{% assign message = 'newsletter.popup_newsletter.message' | t %}
<div class="modal  modal--bg fade"  id="newsletterModal" data-pause="{{ settings.popup_newsletter_delay_first }}">
  <div class="modal-dialog white-modal center-center  modal-md">
    <div class="modal-content modal-md">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="mdi mdi-close"></i></button>
      </div>
      <div class="modal-block">

        <div class="row"> 
                    {% if settings.popup_newsletter_img != blank %}
        <div class="modal-bg-image bottom-right col-sm-6"> 
          <img loading="lazy" height="auto" width="300px" src="{{ 'newsletter-bg.png' | asset_url }}" alt="newsletter-bg" class="img-responsive"> 
        </div>
                    {% endif %}

{% if settings.popup_newsletter_form != blank %}
        <div class="modal-newsletter text-center col-sm-6">
          <img loading="lazy" height="auto" width="220" class="logo img-responsive1" src="{{ 'newsletter-logo.png' | asset_img_url: '220x' }}" alt="newsletter-logo"/>
          <div class="desc">{{ settings.popup_newsletter_description }}</div>
              {% form 'customer' %}
                {% if form.posted_successfully? %}
                  <input type="hidden" name="contact[tags]" value="newsletter">
                  <div class="newsletter-input row-subscibe">
                    <input
                      type="email"
                      value="{% if customer %}{{ customer.email }}{% endif %}"
                      placeholder="{{ 'general.newsletter_form.newsletter_email' | t }}"
                      name="contact[email]"
                      id="Email"
                      class="input-group-field"
                      aria-label="{{ 'general.newsletter_form.newsletter_email' | t }}"
                      autocapitalize="off"
                    >

                    <p class="note form-success">{{ 'general.newsletter_form.confirmation' | t }}</p>
                    <span class="input-group-btns">
                      <button
                        type="submit"
                        class="btn icon-fallback-text"
                        name="commit"
                        id="subscribe"
                        aria-label="Name"
                      >
                        <span class="subscribe">{{ 'general.newsletter_form.submit' | t }}</span>
                      </button>
                    </span>
                  </div>
                {% else %}
                  <input type="hidden" name="contact[tags]" value="newsletter">
                  <div class="newsletter-input row-subscibe">
                    <input
                      type="email"
                      value="{% if customer %}{{ customer.email }}{% endif %}"
                      placeholder="{{ 'general.newsletter_form.newsletter_email' | t }}"
                      name="contact[email]"
                      id="Email"
                      class="input-group-field"
                      aria-label="{{ 'general.newsletter_form.newsletter_email' | t }}"
                      autocapitalize="off"
                    >

                    {{ form.errors | default_errors }}
                    <span class="input-group-btns">
                      <button
                        type="submit"
                        class="btn icon-fallback-text"
                        name="commit"
                        id="subscribe"
                        aria-label="Name"
                      >
                        <span class="subscribe">{{ 'general.newsletter_form.submit' | t }}</span>
                      </button>
                    </span>
                  </div>
                {% endif %}
              {% endform %}
              <div class="checkbox-group form-group-top clearfix">
                <input type="checkbox" id="checkBox">
                <label for="checkBox">
                  <span class="check"></span>
                  <span class="box"></span>
                  {{ 'newsletter.popup_newsletter.question' | t }}
                </label>
              </div>
        </div>
{% endif %}
</div>
        
      </div>
    </div>
  </div>
</div>
<script>
  (function(e) {
    var obj = {
      init: function() {
        try {
          if (e.cookie('popupNewsletter') != 'disable') {
            this.checkboxEvent();
            var pause = e('#newsletterModal').attr('data-pause');
            setTimeout(function() {
              e('#newsletterModal').modal('show');
              var date = new Date();
              var minutes = {{ settings.popup_newsletter_delay }};
              date.setTime(date.getTime() + (minutes * 60 * 1000));
              e.cookie('popupNewsletter', 'disable', {
                expires: date,
                path: '/'
              })
            }, pause)
          }
        } catch (err) {}
      },
      checkboxEvent: function() {
        e('#checkBox').change(function() {
          if (e(this).is(':checked')) {
            e(this).addClass('active');
            e(this).parent().addClass('active');
            e.cookie('popupNewsletter', 'disable', {
              expires: 1,
              path: '/'
            })
          } else {
            e(this).removeClass('active');
            e(this).parent().removeClass('active');
            e.cookie("popupNewsletter", null, {
              path: '/'
            })
          }
        })
      }
    };
    e(document).ready(function() {
      obj.init()
    })
  })(jQuery)
</script>
{% endif %}